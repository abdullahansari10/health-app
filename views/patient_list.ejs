<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Patients</title>
    <%- include("partial/header") %>
  </head>
  <body>
    <%- include("partial/nav") %>
    <div class="container mt-3">
      <div class="row">
        <div class="col-12">
          <div class="">
            <h2 class="mb-3"><strong><%= doctor.name %></strong> (patients-appointment)</h2>
            <% if (appointments.length === 0) { %>
            <p>No patients booked yet.</p>
            <% } else { %>
            <ul>
              <% appointments.forEach(appt => { %>
              <li>
                <b><%= appt.userId.username %></b>
                (<%= appt.userId.email %>) - Appointment Date: <%=
                appt.date.toDateString() %> - Status: <%= appt.status %> <% if
                (appt.status === "pending") { %>
                <form
                  action="/app/accept/<%= appt._id %>"
                  method="POST"
                  style="display: inline"
                >
                  <button class="btn btn-success mb-2" type="submit">
                    Accept
                  </button>
                </form>
                <form
                  action="/app/decline/<%= appt._id %>"
                  method="POST"
                  style="display: inline"
                >
                  <button class="btn btn-danger mb-2" type="submit">
                    Decline
                  </button>
                </form>
                <% } %>
              </li>
              <% }) %>
            </ul>
            <% } %>
          </div>
        </div>
      </div>
    </div>

    <%- include("partial/footer") %>
  </body>
</html>
